const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DKwsCyyk.js","assets/index-5AABAy30.css"])))=>i.map(i=>d[i]);
import{u as k,r as d,j as e,V as T,D as R,C as q,c as O,d as o,e as ie,f as _,X as z,g as I,h as J,_ as Z,P as ue,T as ce,E as ee,i as he,k as ge,I as Q,l as be,m as pe,n as te,R as je,o as fe,a as Ne,A as ye}from"./index-DKwsCyyk.js";import{D as oe,P as de}from"./PDFExportModal-BNcCTPzz.js";import{D as we}from"./SEO-C-BA4dD9.js";const ve=({onSuccess:t,onCancel:l})=>{const{t:s,addNotification:a,startNewApplication:m}=k(),[u,i]=d.useState(null),[p,b]=d.useState(!1),[h,y]=d.useState(1),w=g=>{i(g),y(2)},D=async()=>{if(u){b(!0);try{await m(u),t()}catch{a(s("errorCreatingApplication"),"error")}finally{b(!1)}}},v=g=>{const r=[s("passport"),s("birthCertificate"),s("identityDocument"),s("medicalCertificate")];return g===T.VITEM_XI?[...r,s("familyDocuments"),s("sponsorshipLetter"),s("incomeProof")]:g===T.VITEM_III?[...r,s("humanitarianDocuments"),s("emergencyDocuments")]:r};if(h===1)return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-iom-blue mb-6 text-center",children:s("createNewApplication")}),e.jsx("p",{className:"text-gray-600 text-center mb-8",children:s("selectVisaTypeForNewApplication")}),e.jsxs("div",{className:"space-y-4 max-w-2xl mx-auto",children:[e.jsxs("div",{onClick:()=>w(T.VITEM_XI),className:"p-6 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-iom-blue hover:bg-blue-50 transition-all",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:s(T.VITEM_XI)}),e.jsx("p",{className:"text-gray-600 mb-4",children:s("vitemXIDesc")}),e.jsxs("div",{className:"flex items-center text-sm text-iom-blue",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),s("documentsRequired"),": 7"]})]}),e.jsxs("div",{onClick:()=>w(T.VITEM_III),className:"p-6 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-iom-blue hover:bg-blue-50 transition-all",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:s(T.VITEM_III)}),e.jsx("p",{className:"text-gray-600 mb-4",children:s("vitemIIIDesc")}),e.jsxs("div",{className:"flex items-center text-sm text-iom-blue",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),s("documentsRequired"),": 6"]})]})]}),e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx("button",{onClick:l,className:"px-6 py-3 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:s("cancel")})})]});if(h===2&&u){const g=v(u);return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-iom-blue mb-2",children:s("applicationSummary")}),e.jsx("p",{className:"text-gray-600",children:s("reviewBeforeSubmitting")})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-iom-blue mb-2",children:s("selectedVisaType")}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"w-5 h-5 text-green-500 mr-2"}),e.jsx("span",{className:"font-medium",children:s(u)})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s("documentsYouWillNeed")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:g.map((r,x)=>e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500 mr-3"}),e.jsx("span",{className:"text-sm text-gray-700",children:r})]},x))})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:s("importantNotes")}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsxs("li",{children:["â€¢ ",s("allDocumentsMustBeValid")]}),e.jsxs("li",{children:["â€¢ ",s("processingTimeIs")," 10-15 ",s("businessDays")]}),e.jsxs("li",{children:["â€¢ ",s("applicationFeeWillBeCharged")]}),e.jsxs("li",{children:["â€¢ ",s("youCanTrackProgress")]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:()=>y(1),className:"px-6 py-3 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:s("back")}),e.jsx("button",{onClick:l,className:"px-6 py-3 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:s("cancel")}),e.jsx("button",{onClick:D,disabled:p,className:"flex-1 px-6 py-3 bg-iom-blue text-white rounded-md hover:bg-iom-blue/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),s("creating"),"..."]}):s("createApplication")})]})]})}return null},W=({status:t,className:l=""})=>{const s=m=>{switch(m.toUpperCase()){case"NOT_STARTED":return"bg-gray-100 text-gray-800 border-gray-300";case"PENDING_DOCUMENTS":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"IN_REVIEW":return"bg-blue-100 text-blue-800 border-blue-300";case"APPOINTMENT_SCHEDULED":return"bg-purple-100 text-purple-800 border-purple-300";case"APPROVED":return"bg-green-100 text-green-800 border-green-300";case"REJECTED":return"bg-red-100 text-red-800 border-red-300";case"MISSING":return"bg-gray-100 text-gray-800 border-gray-300";case"UPLOADED":return"bg-blue-100 text-blue-800 border-blue-300";case"VERIFIED":return"bg-green-100 text-green-800 border-green-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},a=m=>m.toLowerCase().split("_").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" ");return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${s(t)} ${l}`,children:a(t)})},me=({application:t,className:l="",compact:s=!1})=>{const{t:a}=k(),m=()=>{var x;return[{id:"application_started",title:a("applicationStarted"),description:a("applicationStartedDesc"),status:"completed",icon:e.jsx(ie,{className:"w-5 h-5"}),date:t.createdAt,details:[a("visaType")+": "+a(t.visaType),a("applicationId")+": "+t.id]},{id:"documents_upload",title:a("documentsUpload"),description:a("documentsUploadDesc"),status:u(),icon:e.jsx(R,{className:"w-5 h-5"}),details:i()},{id:"review_process",title:a("reviewProcess"),description:a("reviewProcessDesc"),status:p(),icon:e.jsx(O,{className:"w-5 h-5"}),details:b()},{id:"appointment_scheduling",title:a("appointmentScheduling"),description:a("appointmentSchedulingDesc"),status:h(),icon:e.jsx(_,{className:"w-5 h-5"}),date:(x=t.appointment)==null?void 0:x.date,details:y()},{id:"final_decision",title:a("finalDecision"),description:a("finalDecisionDesc"),status:w(),icon:t.status===o.APPROVED?e.jsx(q,{className:"w-5 h-5"}):t.status===o.REJECTED?e.jsx(z,{className:"w-5 h-5"}):e.jsx(O,{className:"w-5 h-5"}),details:D()}]},u=()=>{const r=t.documents,x=r.filter(N=>N.status===I.VERIFIED),c=r.filter(N=>N.status===I.REJECTED),f=r.filter(N=>N.status===I.UPLOADED);return c.length>0?"failed":x.length===r.length?"completed":f.length>0||x.length>0?"current":"upcoming"},i=()=>{const r=t.documents,x=r.filter(A=>A.status===I.VERIFIED).length,c=r.filter(A=>A.status===I.UPLOADED).length,f=r.filter(A=>A.status===I.REJECTED).length,N=[`${x} ${a("verified").toLowerCase()}`,`${c} ${a("uploaded").toLowerCase()}`,`${r.length-x-c} ${a("missing").toLowerCase()}`];return f>0&&N.push(`${f} ${a("rejected").toLowerCase()}`),N},p=()=>t.status===o.REJECTED?"failed":t.status===o.APPROVED||t.status===o.APPOINTMENT_SCHEDULED?"completed":t.status===o.IN_REVIEW?"current":"upcoming",b=()=>{const r=[a("currentStatus")+": "+a(t.status)];return t.status===o.IN_REVIEW&&r.push(a("estimatedReviewTime")+": 5-10 "+a("businessDays")),r},h=()=>t.status===o.REJECTED?"failed":t.appointment?t.appointment.status===J.COMPLETED?"completed":t.appointment.status===J.CANCELLED?"failed":"completed":t.status===o.APPROVED?"current":"upcoming",y=()=>t.appointment?[a("status")+": "+a(t.appointment.status),a("date")+": "+new Date(t.appointment.date).toLocaleDateString(),a("time")+": "+t.appointment.time,a("location")+": "+t.appointment.location]:t.status===o.APPROVED?[a("readyToSchedule")]:[a("pendingApproval")],w=()=>{var r;return t.status===o.APPROVED?"completed":t.status===o.REJECTED?"failed":((r=t.appointment)==null?void 0:r.status)===J.COMPLETED?"current":"upcoming"},D=()=>t.status===o.APPROVED?[a("applicationApproved"),a("visaProcessingComplete")]:t.status===o.REJECTED?[a("applicationRejected"),a("contactSupportForDetails")]:[a("pendingFinalReview")],v=r=>{switch(r){case"completed":return{bg:"bg-green-500",border:"border-green-500",text:"text-green-600",icon:"text-white"};case"current":return{bg:"bg-iom-blue",border:"border-iom-blue",text:"text-iom-blue",icon:"text-white"};case"failed":return{bg:"bg-red-500",border:"border-red-500",text:"text-red-600",icon:"text-white"};default:return{bg:"bg-gray-300",border:"border-gray-300",text:"text-gray-500",icon:"text-gray-400"}}},g=m();return s?e.jsx("div",{className:`${l}`,children:e.jsx("div",{className:"flex items-center justify-between",children:g.map((r,x)=>{const c=v(r.status),f=x===g.length-1;return e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-6 h-6 ${c.bg} rounded-full flex items-center justify-center border-2 ${c.border}`,children:e.jsx("div",{className:`${c.icon} text-xs`,children:r.icon})}),e.jsx("span",{className:`text-xs mt-1 text-center max-w-20 ${c.text}`,children:r.title})]}),!f&&e.jsx("div",{className:"flex-1 h-0.5 bg-gray-200 mx-2"})]},r.id)})})}):e.jsxs("div",{className:`bg-white rounded-xl shadow-md p-6 ${l}`,children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(O,{className:"w-6 h-6 text-iom-blue mr-2"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:a("applicationTimeline")})]}),e.jsx("div",{className:"space-y-8",children:g.map((r,x)=>{const c=v(r.status),f=x===g.length-1;return e.jsxs("div",{className:"relative",children:[!f&&e.jsx("div",{className:"absolute left-4 top-10 w-0.5 h-16 bg-gray-200"}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:`relative flex-shrink-0 w-8 h-8 ${c.bg} rounded-full flex items-center justify-center border-2 ${c.border}`,children:[e.jsx("div",{className:c.icon,children:r.icon}),r.status==="current"&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`text-lg font-medium ${c.text}`,children:r.title}),r.date&&e.jsx("span",{className:"text-sm text-gray-500",children:new Date(r.date).toLocaleDateString()})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:r.description}),r.details&&r.details.length>0&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:r.details.map((N,A)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mr-2 flex-shrink-0"}),N]},A))})}),r.status==="current"&&r.id==="review_process"&&e.jsxs("div",{className:"mt-3 bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-iom-blue border-t-transparent"}),e.jsx("span",{className:"text-sm font-medium text-iom-blue",children:a("inProgress")})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:e.jsx("div",{className:"bg-iom-blue h-2 rounded-full animate-pulse",style:{width:"60%"}})})]})]})]})]},r.id)})}),e.jsx("div",{className:"mt-8 pt-6 border-t",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[a("applicationSubmitted"),": ",new Date(t.createdAt).toLocaleDateString()]}),e.jsx("span",{className:`font-medium ${t.status===o.APPROVED?"text-green-600":t.status===o.REJECTED?"text-red-600":"text-iom-blue"}`,children:a(t.status)})]})})]})},De=t=>{switch(t){case o.APPROVED:return e.jsx(q,{className:"w-5 h-5 text-green-600"});case o.IN_REVIEW:return e.jsx(O,{className:"w-5 h-5 text-yellow-600"});case o.REJECTED:return e.jsx(z,{className:"w-5 h-5 text-red-600"});case o.APPOINTMENT_SCHEDULED:return e.jsx(_,{className:"w-5 h-5 text-blue-600"});default:return e.jsx(O,{className:"w-5 h-5 text-gray-600"})}},Ee=t=>{switch(t){case o.APPROVED:return"border-l-green-500 bg-green-50";case o.IN_REVIEW:return"border-l-yellow-500 bg-yellow-50";case o.REJECTED:return"border-l-red-500 bg-red-50";case o.APPOINTMENT_SCHEDULED:return"border-l-blue-500 bg-blue-50";default:return"border-l-gray-500 bg-gray-50"}},Ce=({application:t,isExpanded:l,onToggleExpand:s,onViewFull:a,onDelete:m,onEdit:u})=>{const{t:i}=k(),[p,b]=d.useState(null),[h,y]=d.useState(!1),[w,D]=d.useState(!1),v=c=>{b(c),y(!0)},g=t.documents.filter(c=>c.status===I.VERIFIED).length,r=t.documents.length,x=r>0?g/r*100:0;return e.jsxs("div",{className:`bg-white rounded-lg shadow-md border-l-4 ${Ee(t.status)} transition-all duration-200 hover:shadow-lg`,children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[De(t.status),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:i(t.visaType)}),e.jsx(W,{status:t.status})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i("createdAt"),": ",new Date(t.createdAt).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",t.id.slice(-8)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:a,className:"px-3 py-1.5 text-sm font-medium text-iom-blue hover:text-iom-blue/80 transition-colors",children:i("viewDetails")}),e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors","aria-label":i(l?"collapse":"expand"),children:l?e.jsx(he,{className:"w-5 h-5"}):e.jsx(ge,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:i("documentsProgress")}),e.jsxs("span",{children:[g,"/",r]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(()=>{const c=Math.round(x),f=`progress-w-${c}`;return e.jsx("progress",{value:c,max:100,"aria-label":i("documentsProgress"),title:`${c}%`,className:`progress-bar-inner ${f} h-2 w-full [&::-webkit-progress-bar]:bg-transparent [&::-webkit-progress-value]:bg-iom-blue [&::-moz-progress-bar]:bg-iom-blue`,"data-width":x})})()})]})]}),l&&e.jsx("div",{className:"border-t border-gray-200",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:i("processTimeline")}),e.jsx(me,{application:t,compact:!0})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:i("documents")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.documents.slice(0,4).map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.type}),e.jsx("p",{className:"text-xs text-gray-500",children:i(c.status)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c.status===I.VERIFIED&&e.jsx(q,{className:"w-4 h-4 text-green-600"}),c.filePath&&e.jsx("button",{onClick:()=>v(c),className:"text-xs text-iom-blue hover:text-iom-blue/80",children:i("view")})]})]},c.id))}),t.documents.length>4&&e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:(()=>{var f,N;const c=t.documents.length-4;return((N=(f=i("andXMore"))==null?void 0:f.replace)==null?void 0:N.call(f,"{{count}}",String(c)))??`+ ${c} more`})()})]}),t.appointment&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:i("appointment")}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-blue-900",children:[new Date(t.appointment.date).toLocaleDateString(),i("at")," ",t.appointment.time]}),e.jsx("p",{className:"text-sm text-blue-700",children:t.appointment.location}),e.jsxs("p",{className:"text-xs text-blue-600",children:[i("status"),": ",i(t.appointment.status)]})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>D(!0),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:i("exportPDF")}),e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-white bg-iom-blue rounded-md hover:bg-iom-blue/90 transition-colors",children:i("viewFullDetails")}),t.status!==o.APPROVED&&t.status!==o.APPOINTMENT_SCHEDULED&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(t.id,t.visaType),className:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors flex items-center",title:i("editApplication"),children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(t.id),className:"px-3 py-2 text-sm font-medium text-red-600 bg-red-50 rounded-md hover:bg-red-100 transition-colors flex items-center",title:i("deleteApplication"),children:e.jsx(ce,{className:"w-4 h-4"})})]})]})]})}),h&&p&&e.jsx(oe,{document:p,isOpen:h,onClose:()=>{y(!1),b(null)}}),w&&e.jsx(de,{isOpen:w,onClose:()=>D(!1),application:t,exportType:"application"})]})},ne=({onCreateNew:t,onViewApplication:l,onCountChange:s})=>{const{t:a}=k(),[m,u]=d.useState([]),[i,p]=d.useState(!0),[b,h]=d.useState(new Set),[y,w]=d.useState("all"),[D,v]=d.useState("date"),[g,r]=d.useState(!1),[x,c]=d.useState(null),[f,N]=d.useState(!1),[A,F]=d.useState(!1),[V,L]=d.useState(null),[M,$]=d.useState(null),[U,H]=d.useState(!1);d.useEffect(()=>{B()},[]);const B=async()=>{p(!0);try{const{api:n}=await Z(async()=>{const{api:C}=await import("./index-DKwsCyyk.js").then(P=>P.y);return{api:C}},__vite__mapDeps([0,1])),j=await n.getUserApplications();u(j),s&&s(j.length)}catch(n){console.error("Error fetching applications:",n),s&&s(0)}finally{p(!1)}},E=n=>{const j=new Set(b);j.has(n)?j.delete(n):j.add(n),h(j)},S=n=>{c(n),r(!0)},X=async()=>{if(x){N(!0);try{const{api:n}=await Z(async()=>{const{api:j}=await import("./index-DKwsCyyk.js").then(C=>C.y);return{api:j}},__vite__mapDeps([0,1]));await n.deleteApplication(x),u(j=>{const C=j.filter(P=>P.id!==x);return s&&s(C.length),C}),console.log(a("applicationDeleted"))}catch(n){console.error("Error deleting application:",n),alert(n.message||"Failed to delete application")}finally{N(!1),r(!1),c(null)}}},Y=(n,j)=>{L({id:n,currentVisaType:j}),$(j),F(!0)},xe=async()=>{if(!(!V||!M)){H(!0);try{const{api:n}=await Z(async()=>{const{api:j}=await import("./index-DKwsCyyk.js").then(C=>C.y);return{api:j}},__vite__mapDeps([0,1]));await n.editApplication(V.id,M),await B(),console.log(a("applicationUpdated"))}catch(n){console.error("Error editing application:",n),alert(n.message||"Failed to edit application")}finally{H(!1),F(!1),L(null),$(null)}}},se=m.filter(n=>y==="all"||n.status===y).sort((n,j)=>D==="date"?new Date(j.createdAt).getTime()-new Date(n.createdAt).getTime():n.status.localeCompare(j.status));return i?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-iom-blue"}),e.jsx("span",{className:"ml-4 text-gray-600",children:a("loadingApplications")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:a("myApplications")}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:(()=>{var C,P;const n=m.length;return((P=(C=a(n===1?"applicationsCount_one":"applicationsCount_other"))==null?void 0:C.replace)==null?void 0:P.call(C,"{{count}}",String(n)))??`${n}`})()}),e.jsx("p",{className:"text-xs text-blue-600",children:(()=>{var P,ae,G,re,K,le;const n=m.length,j=5,C=Math.max(0,j-n);return((le=(K=(re=(G=(ae=(P=a("applicationsRemaining"))==null?void 0:P.replace)==null?void 0:ae.call(P,"{{count}}",String(C)))==null?void 0:G.replace)==null?void 0:re.call(G,"{{used}}",String(n)))==null?void 0:K.replace)==null?void 0:le.call(K,"{{total}}",String(j)))??`${C} (${n}/${j})`})()})]})]}),m.length>0&&e.jsxs("button",{onClick:t,className:"mt-4 sm:mt-0 flex items-center px-4 py-2 bg-brazil-green text-white rounded-md hover:bg-brazil-green/90 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),a("createNewApplication")]})]}),m.length>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{htmlFor:"status-filter",className:"text-sm font-medium text-gray-700",children:[a("filterByStatus"),":"]}),e.jsxs("select",{id:"status-filter",value:y,onChange:n=>w(n.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-iom-blue focus:border-iom-blue",children:[e.jsx("option",{value:"all",children:a("allStatuses")}),e.jsx("option",{value:o.PENDING_DOCUMENTS,children:a(o.PENDING_DOCUMENTS)}),e.jsx("option",{value:o.IN_REVIEW,children:a(o.IN_REVIEW)}),e.jsx("option",{value:o.APPOINTMENT_SCHEDULED,children:a(o.APPOINTMENT_SCHEDULED)}),e.jsx("option",{value:o.APPROVED,children:a(o.APPROVED)}),e.jsx("option",{value:o.REJECTED,children:a(o.REJECTED)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{htmlFor:"sort-by",className:"text-sm font-medium text-gray-700",children:[a("sortBy"),":"]}),e.jsxs("select",{id:"sort-by",value:D,onChange:n=>v(n.target.value),className:"text-sm border-gray-300 rounded-md focus:ring-iom-blue focus:border-iom-blue",children:[e.jsx("option",{value:"date",children:a("dateCreated")}),e.jsx("option",{value:"status",children:a("status")})]})]})]}),se.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border-2 border-dashed border-gray-300",children:[e.jsx(R,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:m.length===0?a("noApplicationsYet"):a("noApplicationsMatch")}),e.jsx("p",{className:"text-gray-600 mb-6",children:m.length===0?a("startFirstApplication"):a("adjustFilters")})]}):e.jsx("div",{className:"space-y-4",children:se.map(n=>e.jsx(Ce,{application:n,isExpanded:b.has(n.id),onToggleExpand:()=>E(n.id),onViewFull:()=>l(n),onDelete:S,onEdit:Y},n.id))}),g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(z,{className:"w-8 h-8 text-red-500 mr-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a("deleteApplication")})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:a("confirmDelete")}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:a("deleteWarning")}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{r(!1),c(null)},disabled:f,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50",children:a("cancel")}),e.jsxs("button",{onClick:X,disabled:f,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors disabled:opacity-50 flex items-center",children:[f?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(ce,{className:"w-4 h-4 mr-2"}),f?"Deleting...":a("confirm")]})]})]})}),A&&V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ee,{className:"w-8 h-8 text-blue-500 mr-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a("editVisaType")})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:a("confirmEdit")}),e.jsx("p",{className:"text-sm text-yellow-600 mb-4",children:a("editWarning")}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("selectNewVisaType")}),e.jsxs("select",{"aria-label":a("selectNewVisaType"),value:M||"",onChange:n=>$(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-iom-blue focus:border-transparent",children:[e.jsx("option",{value:T.VITEM_XI,children:a(T.VITEM_XI)}),e.jsx("option",{value:T.VITEM_III,children:a(T.VITEM_III)})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{F(!1),L(null),$(null)},disabled:U,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors disabled:opacity-50",children:a("cancel")}),e.jsxs("button",{onClick:xe,disabled:U||M===V.currentVisaType,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center",children:[U?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(ee,{className:"w-4 h-4 mr-2"}),U?"Updating...":a("confirm")]})]})]})})]})},Ie=({application:t})=>{var B;const{t:l,user:s,scheduleAppointment:a,isLoading:m}=k(),[u,i]=d.useState(""),[p,b]=d.useState(""),[h,y]=d.useState(((B=s==null?void 0:s.dateOfBirth)==null?void 0:B.split("T")[0])||""),[w,D]=d.useState((s==null?void 0:s.passportNumber)||""),[v,g]=d.useState((s==null?void 0:s.nationality)||""),[r,x]=d.useState({}),[c,f]=d.useState(new Date().getMonth()+1),[N,A]=d.useState(new Date().getFullYear());d.useEffect(()=>{(async()=>{try{const S=await be.getAppointmentAvailability(c,N);x(S)}catch(S){console.error("Failed to fetch appointment availability",S)}})()},[c,N]);const F=t.documents.find(E=>E.type==="Identity Document"),V=(F==null?void 0:F.status)===I.VERIFIED,L=h&&w&&v,M=u&&p&&L&&V,$=()=>{M&&a(u,p,{dateOfBirth:h,passportNumber:w,nationality:v})},U=E=>{const S=new Date(E.target.value),X=S.getMonth()+1,Y=S.getFullYear();X!==c&&f(X),Y!==N&&A(Y),i(E.target.value)},H=E=>{const S=r[E];return S?S.status==="full"?"bg-red-300 cursor-not-allowed":S.status==="limited"?"bg-yellow-300":"bg-green-300":"bg-green-100"};return e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsxs("h4",{className:"font-semibold text-lg mb-4 flex items-center",children:[e.jsx(_,{className:"w-5 h-5 mr-2"}),l("scheduleAppointment")]}),e.jsxs("div",{className:"flex space-x-4 mb-4 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-4 h-4 bg-green-300 mr-1"}),l("available")]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-4 h-4 bg-yellow-300 mr-1"}),l("limited")]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-4 h-4 bg-red-300 mr-1"}),l("full")]})]}),e.jsxs("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border-l-4 border-blue-400",children:[e.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:l("appointmentRequirements")}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:`flex items-center ${V?"text-green-700":"text-red-700"}`,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),l("identityDocumentVerified")," ",V?"âœ“":"âœ—"]}),e.jsxs("li",{className:`flex items-center ${L?"text-green-700":"text-red-700"}`,children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),l("personalInfoComplete")," ",L?"âœ“":"âœ—"]})]})]}),!V&&e.jsx("div",{className:"mb-4 bg-red-50 p-4 rounded-lg border-l-4 border-red-400",children:e.jsxs("p",{className:"text-red-800 text-sm",children:[e.jsx(Q,{className:"w-4 h-4 inline mr-1"}),l("identityDocumentRequired")]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:l("fullName")}),e.jsx("input",{id:"fullName",type:"text",value:(s==null?void 0:s.fullName)||"",disabled:!0,className:"w-full p-2 border rounded-md bg-gray-100 text-gray-600"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700 mb-1",children:[l("dateOfBirth")," *"]}),e.jsx("input",{id:"dateOfBirth",type:"date",value:h,onChange:E=>y(E.target.value),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"passport_number",className:"block text-sm font-medium text-gray-700 mb-1",children:[l("passportNumber")," *"]}),e.jsx("input",{id:"passport_number",type:"text",value:w,onChange:E=>D(E.target.value.toUpperCase()),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"AB1234567",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"nationality",className:"block text-sm font-medium text-gray-700 mb-1",children:[l("nationality")," *"]}),e.jsxs("select",{id:"nationality",value:v,onChange:E=>g(E.target.value),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,title:l("selectNationality"),children:[e.jsx("option",{value:"",children:l("selectNationality")}),e.jsx("option",{value:"Haitian",children:"Haitian"}),e.jsx("option",{value:"American",children:"American"}),e.jsx("option",{value:"Canadian",children:"Canadian"}),e.jsx("option",{value:"French",children:"French"}),e.jsx("option",{value:"Dominican",children:"Dominican"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"appointmentDate",className:"flex items-center text-sm font-medium text-gray-700 mb-1",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),l("appointmentDate")," *"]}),e.jsx("input",{id:"appointmentDate",type:"date",value:u,onChange:U,min:new Date().toISOString().split("T")[0],className:`w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${H(new Date(u).getDate())}`,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"appointmentTime",className:"flex items-center text-sm font-medium text-gray-700 mb-1",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),l("appointmentTime")," *"]}),e.jsxs("select",{id:"appointmentTime",value:p,onChange:E=>b(E.target.value),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500",required:!0,title:l("selectTime"),children:[e.jsx("option",{value:"",children:l("selectTime")}),e.jsx("option",{value:"09:00",children:"09:00 AM"}),e.jsx("option",{value:"10:00",children:"10:00 AM"}),e.jsx("option",{value:"11:00",children:"11:00 AM"}),e.jsx("option",{value:"14:00",children:"02:00 PM"}),e.jsx("option",{value:"15:00",children:"03:00 PM"}),e.jsx("option",{value:"16:00",children:"04:00 PM"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:$,disabled:m||!M,className:`w-full font-bold py-2 rounded-lg transition-colors ${M&&!m?"bg-brazil-green text-white hover:bg-brazil-green/90":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,children:l(m?"scheduling":"bookAppointment")})})]}),e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-400",children:e.jsxs("p",{className:"text-yellow-800 text-sm",children:[e.jsx(Q,{className:"w-4 h-4 inline mr-1"}),l("appointmentBookingNote")]})})]})},Se=({doc:t,onViewDocument:l})=>{const{t:s,uploadDocument:a,isLoading:m}=k(),u=je.useRef(null),i=h=>{h.target.files&&h.target.files[0]&&a(t.id,h.target.files[0])},p=()=>{t.filePath&&l(t)},b=()=>{switch(t.status){case I.VERIFIED:return e.jsx(q,{className:"w-4 h-4 text-green-600"});case I.UPLOADED:return e.jsx(O,{className:"w-4 h-4 text-blue-600"});case I.REJECTED:return e.jsx(z,{className:"w-4 h-4 text-red-600"});default:return e.jsx(R,{className:"w-4 h-4 text-gray-400"})}};return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6 text-gray-700 font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[b(),e.jsxs("div",{children:[e.jsx("span",{children:t.type}),t.status===I.REJECTED&&t.rejectionReason&&e.jsxs("div",{className:"mt-2 flex items-start text-xs text-red-600",children:[e.jsx(Q,{className:"w-4 h-4 mr-1.5 flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:"flex-1",children:[e.jsxs("b",{children:[s("rejectionNote"),":"]})," ",t.rejectionReason]})]})]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx(W,{status:t.status})}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-500",children:t.fileName||"â€”"}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-500",children:t.filePath?new Date().toLocaleDateString():"â€”"}),e.jsx("td",{className:"py-4 px-6",children:t.status===I.MISSING||t.status===I.REJECTED?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:u,onChange:i,className:"hidden","aria-label":"Upload document",title:"Upload document"}),e.jsxs("button",{onClick:()=>{var h;return(h=u.current)==null?void 0:h.click()},disabled:m,className:"bg-iom-blue text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-iom-blue/90 flex items-center disabled:bg-gray-400 transition-colors",children:[e.jsx(fe,{className:"w-4 h-4 mr-1"}),s("upload")]})]}):e.jsxs("button",{onClick:p,disabled:!t.filePath,className:"bg-gray-100 text-gray-700 px-3 py-1.5 rounded-md text-sm font-medium hover:bg-gray-200 flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),s("view")]})})]})},Ae=({application:t})=>{const{t:l}=k();if(t.appointment){const h=t.appointment.status===J.CONFIRMED?"green":"blue",y=t.appointment.status===J.CONFIRMED?"âœ“":"ðŸ“…";return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(_,{className:"w-6 h-6 text-iom-blue mr-2"}),l("appointment")]}),e.jsxs("div",{className:`flex items-center justify-between p-4 bg-${h}-50 rounded-lg`,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 bg-${h}-100 rounded-full flex items-center justify-center`,children:e.jsx(_,{className:`w-6 h-6 text-${h}-600`})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-lg text-gray-900",children:[y," ",new Date(t.appointment.date).toLocaleDateString(),l("at")," ",t.appointment.time]}),e.jsx("p",{className:"text-gray-600",children:t.appointment.location}),e.jsx("div",{className:"flex items-center mt-2",children:e.jsx(W,{status:t.appointment.status})})]})]}),t.appointment.confirmationLetterPath&&e.jsxs("button",{onClick:()=>window.open(t.appointment.confirmationLetterPath,"_blank"),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),l("downloadLetter")]})]})]})}if(t.status===o.APPROVED)return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(_,{className:"w-6 h-6 text-iom-blue mr-2"}),l("scheduleAppointment")]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{className:"w-6 h-6 text-blue-600"}),e.jsx("p",{className:"text-blue-800 font-medium",children:l("appointmentPromptApproved")})]})}),e.jsx(Ie,{application:t})]});const a=(()=>{switch(t.status){case o.PENDING_DOCUMENTS:return l("noAppointment");case o.IN_REVIEW:return l("appointmentPromptReview");case o.REJECTED:return l("applicationRejectedMessage");default:return l("noAppointment")}})(),m=t.status===o.REJECTED,u=m?z:O,i=m?"text-red-600":"text-yellow-600",p=m?"bg-red-50":"bg-yellow-50",b=m?"border-red-200":"border-yellow-200";return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(_,{className:"w-6 h-6 text-iom-blue mr-2"}),l("appointment")]}),e.jsxs("div",{className:`flex items-center space-x-4 p-4 ${p} border ${b} rounded-lg`,children:[e.jsx(u,{className:`w-8 h-8 ${i}`}),e.jsx("p",{className:`font-medium ${i.replace("text-","text-")} text-gray-800`,children:a})]})]})},Pe=({application:t,onBack:l})=>{const{t:s}=k(),[a,m]=d.useState(null),[u,i]=d.useState(!1),[p,b]=d.useState(!1),[h,y]=d.useState("application"),w=x=>{m(x),i(!0)},D=x=>{y(x),b(!0)},v=t.documents.filter(x=>x.status===I.VERIFIED).length,g=t.documents.length,r=g>0?v/g*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4 sm:mb-0",children:[e.jsx("button",{onClick:l,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors","aria-label":s("goBack"),children:e.jsx(pe,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-3",children:[e.jsx("span",{children:s(t.visaType)}),e.jsx(W,{status:t.status})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s("applicationId"),": ",t.id]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s("createdAt"),": ",new Date(t.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>D("application"),className:"flex items-center px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",title:s("exportApplicationReport"),children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),s("exportReport")]}),e.jsxs("button",{onClick:()=>D("document-checklist"),className:"flex items-center px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",title:s("exportDocumentChecklist"),children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),s("checklist")]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:s("overallProgress")}),e.jsxs("span",{children:[Math.round(r),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-iom-blue h-3 rounded-full transition-all duration-500",style:{width:`${r}%`}})})]})]}),e.jsx(me,{application:t}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:s("applicationDetails")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:s("visaType")}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:s(t.visaType)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:s("status")}),e.jsx("div",{className:"mt-2",children:e.jsx(W,{status:t.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:s("submitted")}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:s("documentsCompleted")}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:[v," / ",g]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:s("applicationId")}),e.jsx("p",{className:"text-lg font-mono text-gray-900 mt-1",children:t.id.slice(-12)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[e.jsx(R,{className:"w-6 h-6 text-iom-blue mr-2"}),s("documents")," (",v,"/",g,")"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"py-3 px-6 text-left font-medium text-gray-600",children:s("documentColumn")}),e.jsx("th",{className:"py-3 px-6 text-left font-medium text-gray-600",children:s("status")}),e.jsx("th",{className:"py-3 px-6 text-left font-medium text-gray-600",children:s("fileNameColumn")}),e.jsx("th",{className:"py-3 px-6 text-left font-medium text-gray-600",children:s("uploadDateColumn")}),e.jsx("th",{className:"py-3 px-6 text-left font-medium text-gray-600",children:s("actions")})]})}),e.jsx("tbody",{children:t.documents.map(x=>e.jsx(Se,{doc:x,onViewDocument:w},x.id))})]})})]}),e.jsx(Ae,{application:t}),u&&a&&e.jsx(oe,{document:a,isOpen:u,onClose:()=>{i(!1),m(null)}}),p&&e.jsx(de,{isOpen:p,onClose:()=>b(!1),application:t,exportType:h})]})},_e=()=>{const{t,user:l,isLoading:s,isAuthenticated:a}=k(),m=Ne(),[u,i]=d.useState("list"),[p,b]=d.useState(null),[h,y]=d.useState(0);if(d.useEffect(()=>{!s&&!a&&m(ye.AUTH)},[s,a,m]),s)return e.jsxs("div",{className:"flex justify-center items-center h-screen",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-iom-blue"}),e.jsx("span",{className:"ml-4 text-gray-600",children:t("loading")})]});if(!l)return null;const w=()=>{i("create"),b(null)},D=c=>{b(c),i("details")},v=()=>{i("list"),b(null)},g=()=>{i("list"),b(null)},r=()=>{i("list"),b(null)},x=()=>{switch(u){case"create":return e.jsx(ve,{onSuccess:g,onCancel:r});case"details":return p?e.jsx(Pe,{application:p,onBack:v}):(i("list"),null);case"list":default:return e.jsx(ne,{onCreateNew:w,onViewApplication:D})}};return e.jsxs(e.Fragment,{children:[e.jsx(we,{}),e.jsx("div",{className:"bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u==="list"&&h===0&&e.jsxs("div",{className:"mb-8 text-center bg-white rounded-lg p-8 shadow-sm border border-gray-200",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:t("welcomeMessage")}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto mb-6",children:t("noApplicationMessage")}),e.jsx("button",{onClick:w,className:"inline-flex items-center px-6 py-3 bg-brazil-green text-white font-medium rounded-md hover:bg-brazil-green/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brazil-green transition-colors",children:t("startFirstApplication")})]}),u==="list"&&h>0&&e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:t("myApplications")})}),e.jsx("div",{className:"w-full",children:u==="list"?e.jsx(ne,{onCreateNew:w,onViewApplication:D,onCountChange:y}):x()})]})})]})};export{_e as default};
