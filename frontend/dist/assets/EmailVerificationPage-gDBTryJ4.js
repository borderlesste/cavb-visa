import{r as t,j as e,b as m}from"./index-DKwsCyyk.js";const S=()=>{const o=(()=>{const r=(window.location.hash||window.location.pathname).match(/\/verify-email\/([^\/\?]+)/);return r?r[1]:null})(),v=()=>{window.location.hash="#/"},w=()=>{window.location.hash="#/auth"},[N,f]=t.useState(!0),[n,k]=t.useState(null),[x,a]=t.useState(null),[h,g]=t.useState(!1),[l,b]=t.useState(""),[u,y]=t.useState(null),c=(s,r)=>{y({message:s,type:r}),setTimeout(()=>y(null),5e3)},i=s=>({verifyingEmail:"Verifying Email",pleaseWait:"Please wait while we verify your email address...",emailVerified:"Email Verified Successfully",verificationFailed:"Email Verification Failed",alreadyVerifiedInfo:"Your email was already verified. You can proceed to login.",welcomeEmailSent:"A welcome email has been sent to your inbox.",goToLogin:"Go to Login",goToHome:"Go to Home"})[s]||s,E=async()=>{if(!l.trim()){c("Please enter your email address","error");return}g(!0);try{const s=await fetch("/api/auth/resend-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.trim()})}),r=await s.json();s.ok?(c("Verification email sent! Please check your email.","success"),b("")):c(r.message||"Failed to send verification email","error")}catch{c("Network error occurred","error")}finally{g(!1)}};t.useEffect(()=>{if(!o){a("No verification token provided"),f(!1);return}(async()=>{try{console.log("[EmailVerification] Verifying token",o,"URL base",`${m.BASE_URL}${m.AUTH}/verify-email/${o}`);const r=await fetch(`${m.BASE_URL}${m.AUTH}/verify-email/${o}`,{method:"GET",headers:{"Content-Type":"application/json"}});let d=null;try{d=await r.json()}catch(T){console.error("[EmailVerification] Failed to parse JSON response",T),a("Unexpected server response while verifying");return}console.log("[EmailVerification] Response status",r.status,"data",d),r.ok?k(d):a(d.message||"Verification failed")}catch(r){console.error("[EmailVerification] Network error",r),a("Network error occurred while verifying email")}finally{f(!1)}})()},[o]);const p=()=>{w()},j=()=>{v()};if(N)return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:[u&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-md shadow-md z-50 ${u.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:u.message}),e.jsx("div",{className:"max-w-md w-full space-y-8 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:i("verifyingEmail")}),e.jsx("p",{className:"text-gray-600",children:i("pleaseWait")})]})})]});if(x)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full space-y-8 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-red-100 flex items-center justify-center mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:i("verificationFailed")}),e.jsx("p",{className:"text-gray-600 mb-6",children:x}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Need a new verification email?"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",placeholder:"Enter your email address",value:l,onChange:s=>b(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),e.jsx("button",{onClick:E,disabled:h||!l.trim(),className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:bg-gray-400",children:h?"Sending...":"Resend Verification Email"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:j,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:i("goToHome")}),e.jsx("button",{onClick:p,className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:i("goToLogin")})]})]})})});if(n){const s=n.verified||n.alreadyVerified;return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full space-y-8 p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`mx-auto h-12 w-12 rounded-full flex items-center justify-center mb-4 ${s?"bg-green-100":"bg-red-100"}`,children:s?e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:i(s?"emailVerified":"verificationFailed")}),e.jsx("p",{className:"text-gray-600 mb-6",children:n.message}),s&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-blue-700",children:n.alreadyVerified?i("alreadyVerifiedInfo"):i("welcomeEmailSent")})})]})}),e.jsxs("div",{className:"space-y-3",children:[s&&e.jsx("button",{onClick:p,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:i("goToLogin")}),e.jsx("button",{onClick:j,className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:i("goToHome")})]})]})})})}return null};export{S as default};
